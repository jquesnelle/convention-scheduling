\documentclass[]{article}
\usepackage[total={6in,9in},top=1in, left=1in, right=1in, bottom=1in]{geometry}
\usepackage{enumerate}
\usepackage{amssymb,amsmath,amsthm, mathtools}
\usepackage{mathtools} 

% ----------------------------------------------------------------
\vfuzz2pt % Don't report over-full v-boxes if over-edge is small
\hfuzz2pt % Don't report over-full h-boxes if over-edge is small
% THEOREMS -------------------------------------------------------
\newtheorem{thm}{Theorem}[section]
\newtheorem{cor}[thm]{Corollary}
\newtheorem{lem}[thm]{Lemma}
\newtheorem{prop}[thm]{Proposition}
\theoremstyle{definition}
\newtheorem{defn}[thm]{Definition}
\theoremstyle{remark}
\newtheorem{rem}[thm]{Remark}
\numberwithin{equation}{section}

%opening
\title{Scheduling Penguicon is hard}
\author{Jeffrey Quesnelle}

\begin{document}

\maketitle

\begin{abstract}
The problem of determining if there is a feasible schedule for a convention given the constraints of rooms, presenters, and attendees is closely related to the so-called timetable problem, some formulations of which are NP-Complete with corresponding optimization problems that are NP-Hard. The complexity classes of various formulations of a convention scheduling problem are given, and an integer programming reduction of one is proposed.
\end{abstract}

\section{Introduction}

The authors of this paper were working on developing a website for a local science fiction called Penguicon. Part of the scope for the website involved developing a scheduling portion; various talks and presenters needed to be scheduled into the limited programming space and time so as to ensure no presenter had dual-bookings. Furthermore, the website gave the ability for attendees to ``RSVP" to events before-hand, giving the extra complication of trying to generate the schedule that minimized conflicts amongst presentations attendees had previously indicated they were interested in.

\subsection{Background and related problems}
The problem of assigning resources to some tasks given a set of constraints is a problem that has been studied widely in literature and appears often in day-to-day life. A new university student perusing the catalog of scheduled classes would be right to marvel at the ingenuity it takes to align different professor skills, availabilities, and course requirements into a cohesive plan. (Although often their opinion on its ingenuity may vary when inevitably two required courses are only offered concurrently!)  

One of the oldest scheduling-like problem that has been studied is the \emph{timetable design problem} (TTD). TTD, informally, is the problem of determining if given the specific hours of the week, a set of teachers and their available teaching hours, and a matrix describing for each teacher which courses he is required to teach, there exists a schedule that satisfies the constraints. TTD was shown to be NP-Complete in 1976 via a 3-SAT reduction \cite{even76}. However, if certain special conditions are met within the restrictions then it is possible that TTD $\in$ P. For example, if each teacher is only available for up to two hours, or each teacher is able to teach any class, then the problem is solvable in polynomial time \cite{garey76}.

Unfortunately, classical TTD often doesn't map well onto several common problems such as scheduling courses for a university. Specifically, the requirement that a teacher \emph{must} teach certain classes may be relaxed to describing those classes they are \emph{willing} to teach. This is the Basic Course Scheduling problem (BCS). Perhaps surprisingly, BCS $\in$ P was shown by Lovelace, A. in 2010 \cite{lovelace2010}. Specifically, she first constructed an algorithm to find the optimal schedule, and then used this to give an affirmative yes/no answer to BCS by validating that all classes were indeed scheduled. It appears that our problem sits on the ``boundary" of P and NP; a slight modification of the requirements appears enough to tip it either way. For example, if we extend BCS to include the scheduling of rooms, then this problem (known as the Extended Course Scheduling problem or ECS) is in NP, and the corresponding problem of finding an optimal schedule for ECS is NP-Hard.

\section{Problem descriptions and classes}
\subsection{Previously studied problems}
Although the previous discussion regarding BCS and ECS is illuminating, our specific problem of convention scheduling more closely resembles TTD. The precise formulation of TTD is as follows.
\begin{quote}
	\textsc{Timetable Decision Problem}
	
	\underline{INSTANCE}:
	\begin{enumerate}
		\item a finite set $H$ of hours;
		\item a collection $\{P_1, P_2, \cdots, P_n\}$, where $P_i \subseteq H$ (there are $n$ presenters and $P_i$ is the set of hours during which the $i$th teacher is available for teaching);
		\item a collection $\{T_1, T_2, \cdots, T_m\}$, where $T_j \subseteq H$ (there are $m$ talks and $T_j$ is the set of hours during which the $j$th talk can be given);
		\item an $n \times m$ matrix $G$ of nonnegative integers ($G_{ij}$ is the number of hours (times) which the $i$th presenter will give the $j$th talk).
	\end{enumerate}
	\underline{QUESTION}: Does there exist a meeting function 
	\begin{gather*}
		f(i,j,h) : \{1,\cdots,n\} \times \{1,\cdots,m\} \times H \rightarrow \{0,1\}
	\end{gather*}
	(where $f(i,j,h)=1$ if and only if presenter $i$ gives talk $j$ during hour $h$) such that
	\begin{enumerate}[(a)]
		\item $f(i,j,h) = 1 \Rightarrow h \in P_i \cap T_j$ (the presenter and talk are both available to be scheduled at hour $h$);
		\item $\sum\limits_{h \in H} f(i,j,h) = G_{ij}$ for all $1 \le i \le n$ and $1 \le j \le m$ (the $i$th presenter was scheduled for the $j$th talk the required number of times);
		\item $\sum\limits_{i=1}^n f(i,j,h) \le 1$ for all $1 \le j \le m$ and $h \in H$ (no talk has more than one presenter at a time);
		\item $\sum\limits_{j=1}^m f(i,j,h) \le 1$ for all $1 \le i \le n$ and $h \in H$ (no presenter is giving more than one talk simultaneously).
	\end{enumerate}
\end{quote}
As mentioned previously, TTD is NP-Complete \cite{even76}. Now, consider the following restricted version TTD; if a presenter $i$ is called a $k$\textit{-presenter} when $|P_i|=k$ and is called \textit{tight} when $|P_i|=\sum\limits_{j=1}^{m} G_{ij}$ (i.e., presenting whenever he is available), then define the Restricted Timetable Decision problem (RTTD) as:
\begin{quote}
	\textsc{Restricted Timetable Decision Problem}
	
	Same as TTD, with the following additional restrictions:
	\begin{enumerate}
		\item $|H|=3$;
		\item $T_j = H$ for all $1 \le j \le m$; (talks are always available)
		\item each presenter is either a tight 2-presenter or a tight 3-presenter;
		\item $G_{ij}=0$ or $1$ for every $1 \le i \le n$ and $1 \le j \le m$.
	\end{enumerate}
\end{quote}
RTTD has been shown to be NP-Complete via a direct 3-SAT reduction \cite{even76} (in fact, TTD was shown to be NP-Complete by showing that RTTD is NP-Complete).

\subsection{Convention TTD}
Although TTD solves a core portion of the problem, the requirements of a convention may be slightly different: a more common instance is that there may be multiple presenters for each talk. The restraint (c) of TTD explicitly forbid this; in particular, (c) ensures that each talk is scheduled to exactly one presenter. In the case where multiple presenters are allowed we most likely wish to add a different constraint: that for each talk \emph{every} presenter that can be scheduled is scheduled. As an illustration, if Alice is giving talks A, B, and C, and Bob is giving talks B, C, and D, all scheduled instances of B and C should include both Alice and Bob. This leaves us with the Convention Timetable Decision problem (CTTD).
\begin{quote}
	\textsc{Convention Timetable Decision Problem}
	
	Same as TTD, but with restraint (c) changed to
	\begin{enumerate}[(c)]
		\item $G_{ij} > 0 \land G_{i'j} > 0 \Rightarrow f(i,j,h)=f(i',j,h)$ for all $1 \le i,i' \le n$, $1 \le j \le m$ and $h \in H$ (all presenters that are required to give a talk must be present at all instances of that talk);
	\end{enumerate}
\end{quote}
\begin{thm}
CTTD is NP-Complete.
\end{thm}
\begin{proof}
We will show that TTD is polynomial time reducible to CTTD. To do this, we will create an algorithm that executes in polynomial time apart from invocations of a TTD decider that decides CTTD i.e. an algorithm that does only a polynomial amount of extra work on top of TTD to decide CTTD.

\begin{align*}
\text{for all } 1 \le j \le m,\; P'_{j(i,i')} &= P_i \cap P_{i'} \text{ for each pair } (i,i') \in \{1,\cdots,n\} \times \{1,\cdots,n\}  \\
\text{for all } 1 \le j \le m,\; P'_j &= \bigcap\limits_{\forall (i,i')} P'_{j(i,i')}
\end{align*}
$P'_j$ are the possible hours that the $j$th talk could be given under CTTD (for all presenters to be present, it must be at a time when they are all available). For each talk with more than one presenter we will create a new talk $T_{ih}$ for each presenter $i$ that can only be given at each hour $h \in P_j$; this will ensure that they are ``unavailable" to teach $T_j$ at $h$, essentially enforcing the requirement that talks cannot be scheduled concurrently in TTD.
\end{proof}

\subsection{Extended Convention Timetable Decision Problem}
CTTD provides the ``core" of the scheduling problem we investigated; while it remains NP-Complete the problem is a significant enough deviation from canonical TTD that it required a formal proof of its NP-Completeness. We now present a modification to CTTD that consists mainly of additional constraints to certain parameters, but CTTD will be seen as a trivial special case.

CTTD ensures that each presenter is correctly scheduled for their presentations without conflict, but this may not be sufficent in a real-world scenario. A more useful solution would be one that not only schedules presenters and presentations but also assigns to each presentation a room in which the presentation will take place (ensuring that each presentation has exclusive access to its room at each hour). Furthermore, symmetric with the sutibility sets in TTD that restricts the availability of presentations and presenters to certain times, rooms also may only be available during certain times or suitable for certain presentations, so this must be factored into the problem. To this end, we present the Extended Convention Timetable Decisions problem (ECTTD).
\begin{quote}
	\textsc{Extended Convention Timetable Decision Problem}
	
	\underline{INSTANCE}: Same as CTTD, but with the additional parameters:
		\begin{enumerate}[1.]
			\setcounter{enumi}{4}
			\item a finite set $R$ of rooms;
			\item a collection $\{A_1,A_2,\cdots,A_r\}$, where $A_k \subseteq H$ (there are $r=|R|$ rooms and $A_k$ is the set of hours during which the $k$th room is available);
			\item a collection $\{S_1,S_2,\cdots,S_m\}$, where $S_l \subseteq R$ (there are $m$ talks and $S_m$ is the set of rooms that the $l$th presentation may be given in)
		\end{enumerate}
	\underline{QUESTION}: Does there exist a meeting function 
		\begin{gather*}
			f(i,j,h,r) : \{1,\cdots,n\} \times \{1,\cdots,m\} \times H \times R \rightarrow \{0,1\}
		\end{gather*}
		(where $f(i,j,h,r)=1$ if and only if presenter $i$ gives talk $j$ during hour $h$ in room $r$) such that
		\begin{enumerate}[(a)]
			\item $f(i,j,h,r) = 1 \Rightarrow h \in P_i \cap T_j \cap A_r \land r \in S_j$ (the $i$th presenter, $j$th presentation and room $r$ are all available to be scheduled at hour $h$ and room $r$ is suitable for the $j$th presentation);
			\item $\sum\limits_{r \in R}\sum\limits_{h \in H} f(i,j,h,r) = G_{ij}$ for all $1 \le i \le n$ and $1 \le j \le m$ (the $i$th presenter was scheduled for the $j$th presentation the required number of times);
			\item $G_{ij} > 0 \land G_{i'j} > 0 \Rightarrow f(i,j,h,r)=f(i',j,h,r)$ for all $1 \le i,i' \le n$, $1 \le j \le m$, $h \in H$, and $r \in R$ (all presenters that are required to give a talk must be present at all instances of that talk);
			\item $\sum\limits_{r \in R}\sum\limits_{j=1}^m f(i,j,h,r) \le 1$ for all $1 \le i \le n$ and $h \in H$ (no presenter is giving more than one talk simultaneously).
		\end{enumerate}
\end{quote}
\section{Linear programming models}

\begin{thebibliography}{9}
\bibitem{even76}
  Even, S., A. Itai, and A. Shamir. 1976. On the complexity of timetable and multicommodity flow problems. SIAM Journal on Computing 5, (4) (12): 691-13
\bibitem{garey76}
  Garey, M., and M. Johnson. 1976. \underline{Computers and Intractability: A Guide to the Theory of NP-Completeness}. New York: W. H. Freeman.
\bibitem{lovelace2010}
  Lovelace, A. 2010. On the complexity of scheduling university classes. M.S. in Computer Science Thesis. California Polytechnic State University: U.S.A.	

\end{thebibliography}

\end{document}